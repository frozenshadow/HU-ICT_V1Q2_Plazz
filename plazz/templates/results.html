{% extends "partials/base.html" %}
{% load l10n %}

{% block headincludes %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
.stars-outer {
  display: inline-block;
  position: relative;
  font-family: FontAwesome;
}

.stars-outer::before {
  content: "\f006 \f006 \f006 \f006 \f006";
}

.stars-inner {
  position: absolute;
  top: 0;
  left: 0;
  white-space: nowrap;
  overflow: hidden;
  width: 0;
}

.stars-inner::before {
  content: "\f005 \f005 \f005 \f005 \f005";
  color: #f8ce0b;
}
    </style>
{% endblock %}

<!-- Initial Page, "data-name" contains page name -->
{% block content %}
<div data-name="results" class="page">
    <!-- Fixed/Dynamic Navbar -->
    <div class="navbar no-hairline no-shadow">
        <div class="navbar-inner sliding">
{% comment %}            <div class="left">
                <a href="/filters" class="link">
                    <i class="icon icon-back"></i>
                    <span class="ios-only">Filters</span>
                </a>
            </div>{% endcomment %}
        </div>
    </div>

    <div class="page-content login-screen-content">
        <div class="block inset">
            <div class="card data-table data-table-collapsible data-table-init">
                <div class="card-header">
                    <div class="data-table-title">Resultaat</div>
                </div>
                <div class="card-content">
                    <table id="resultTable" class="sortable">
                        <thead>
                        <tr>
                            <th class="label-cell sortable-cell">Locatie</th>
                            <th class="numeric-cell sortable-cell">Huurprijs</th>
{#                            <th class="numeric-cell sortable-cell">Concurentie</th>#}
{#                            <th class="numeric-cell sortable-cell">Aantal bewoners (12 Km straal)</th>#}
                            <th class="numeric-cell sortable-cell">Geschiktheid</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for row in results %}
                            <tr class="star_{{ forloop.counter }}">
                                <td class="label-cell">{{ row.0.street.name }} {{ row.0.house_nr }}</td>
                                <td class="numeric-cell">â‚¬ {{ row.0.rent_month }}</td>
{#                                <td class="numeric-cell">3</td>#}
{#                                <td class="numeric-cell">83.544</td>#}
                                <td class="numeric-cell" sorttable_customkey="{{ row.1|unlocalize }}">
                                        <div class="stars-outer">
                                          <div class="stars-inner"></div>
                                        </div>
                                    </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="block inset" style="display: none">
            <div class="card card-outline">
                <div class="card-content">
                    <div id="map" style='height: 500px;'></div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ block.super }}
    <script>
    var ratings = {
        {% for row in results %}
            {% if forloop.last %}
            star_{{ forloop.counter }}: {{ row.1|unlocalize }}
                {% else %}
                star_{{ forloop.counter }}: {{ row.1|unlocalize }},
            {% endif %}
        {% endfor %}
    }

// total number of stars
var starTotal = 5;

for (var rating in ratings) {
  var starPercentage = ratings[rating] / starTotal * 100;
    document.querySelector("." + rating + " .stars-inner").style.width = Math.round(starPercentage / 10) * 10 + "%";
}
    </script>
{% endblock %}